{"ast":null,"code":"const API_BASE = process.env.REACT_APP_API_BASE || \"\";\nexport const login = async ({\n  username,\n  password,\n  role\n}) => {\n  const response = await fetch(`${API_BASE}/api/login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      username,\n      password,\n      role\n    })\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const register = async payload => {\n  const response = await fetch(`${API_BASE}/api/register`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify(payload)\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const guestLogin = async () => {\n  const response = await fetch(`${API_BASE}/api/guest-login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\"\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const fetchMe = async () => {\n  const response = await fetch(`${API_BASE}/api/me`, {\n    credentials: \"include\"\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const logout = async () => {\n  const response = await fetch(`${API_BASE}/api/logout`, {\n    method: \"POST\",\n    credentials: \"include\"\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const switchRole = async role => {\n  const response = await fetch(`${API_BASE}/api/switch-role`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      role\n    })\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\n\n// ===============================\n// ✅ NUEVO: Password Reset\n// ===============================\nexport const requestPasswordReset = async ({\n  email,\n  role\n}) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/request`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    // no necesitas cookies aquí, pero no molesta\n    credentials: \"include\",\n    body: JSON.stringify({\n      email,\n      role\n    })\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const confirmPasswordReset = async ({\n  email,\n  role,\n  token,\n  new_password\n}) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/confirm`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      email,\n      role,\n      token,\n      new_password\n    })\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","login","username","password","role","response","fetch","method","headers","credentials","body","JSON","stringify","json","then","data","register","payload","guestLogin","fetchMe","logout","switchRole","requestPasswordReset","email","confirmPasswordReset","token","new_password"],"sources":["C:/Users/JuanCamachoFernandez/Downloads/Nueva carpeta/aplicacion_microempresa/frontend/src/controllers/authController.js"],"sourcesContent":["const API_BASE = process.env.REACT_APP_API_BASE || \"\";\n\nexport const login = async ({ username, password, role }) => {\n  const response = await fetch(`${API_BASE}/api/login`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ username, password, role }),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const register = async (payload) => {\n  const response = await fetch(`${API_BASE}/api/register`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify(payload),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const guestLogin = async () => {\n  const response = await fetch(`${API_BASE}/api/guest-login`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const fetchMe = async () => {\n  const response = await fetch(`${API_BASE}/api/me`, {\n    credentials: \"include\",\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const logout = async () => {\n  const response = await fetch(`${API_BASE}/api/logout`, {\n    method: \"POST\",\n    credentials: \"include\",\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const switchRole = async (role) => {\n  const response = await fetch(`${API_BASE}/api/switch-role`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ role }),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\n// ===============================\n// ✅ NUEVO: Password Reset\n// ===============================\nexport const requestPasswordReset = async ({ email, role }) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/request`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    // no necesitas cookies aquí, pero no molesta\n    credentials: \"include\",\n    body: JSON.stringify({ email, role }),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const confirmPasswordReset = async ({ email, role, token, new_password }) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/confirm`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ email, role, token, new_password }),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}