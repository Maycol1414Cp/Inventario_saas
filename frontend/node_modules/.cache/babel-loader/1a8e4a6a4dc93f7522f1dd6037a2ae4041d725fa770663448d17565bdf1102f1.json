{"ast":null,"code":"const API_BASE = process.env.REACT_APP_API_BASE || \"\";\nconst safeJson = async response => {\n  try {\n    return await response.json();\n  } catch {\n    return {};\n  }\n};\n\n// ==============================\n// PLANES\n// ==============================\nexport const fetchPlans = async () => {\n  const response = await fetch(`${API_BASE}/api/plans`, {\n    credentials: \"include\"\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\n\n// ==============================\n// ONBOARDING MICROEMPRESA (wizard)\n// ==============================\n\n// Paso 1: crear microempresa PENDIENTE (sin login)\nexport const startMicroempresaOnboarding = async payload => {\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/start`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify(payload)\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\n\n// Paso 3: subir comprobante + plan elegido (multipart)\nexport const submitMicroempresaPayment = async ({\n  signup_id,\n  id_plan,\n  file\n}) => {\n  const formData = new FormData();\n  formData.append(\"signup_id\", String(signup_id));\n  formData.append(\"id_plan\", String(id_plan));\n  formData.append(\"file\", file);\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/submit`, {\n    method: \"POST\",\n    credentials: \"include\",\n    body: formData\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\n\n// Consultar estado (en espera / aprobado / rechazado)\nexport const getOnboardingStatus = async signup_id => {\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/status?signup_id=${encodeURIComponent(String(signup_id))}`, {\n    credentials: \"include\"\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\n\n// ==============================\n// SUPER USUARIO: pendientes\n// ==============================\nexport const fetchPendingMicroempresas = async () => {\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/pending`, {\n    credentials: \"include\"\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\nexport const approvePendingMicroempresa = async tenant_id => {\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/${encodeURIComponent(String(tenant_id))}/approve`, {\n    method: \"PATCH\",\n    credentials: \"include\"\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\nexport const rejectPendingMicroempresa = async tenant_id => {\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/${encodeURIComponent(String(tenant_id))}/reject`, {\n    method: \"PATCH\",\n    credentials: \"include\"\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","safeJson","response","json","fetchPlans","fetch","credentials","data","startMicroempresaOnboarding","payload","method","headers","body","JSON","stringify","submitMicroempresaPayment","signup_id","id_plan","file","formData","FormData","append","String","getOnboardingStatus","encodeURIComponent","fetchPendingMicroempresas","approvePendingMicroempresa","tenant_id","rejectPendingMicroempresa"],"sources":["C:/Users/JuanCamachoFernandez/Downloads/Nueva carpeta/aplicacion_microempresa/frontend/src/controllers/subscriptionController.js"],"sourcesContent":["const API_BASE = process.env.REACT_APP_API_BASE || \"\";\r\n\r\nconst safeJson = async (response) => {\r\n  try {\r\n    return await response.json();\r\n  } catch {\r\n    return {};\r\n  }\r\n};\r\n\r\n// ==============================\r\n// PLANES\r\n// ==============================\r\nexport const fetchPlans = async () => {\r\n  const response = await fetch(`${API_BASE}/api/plans`, {\r\n    credentials: \"include\",\r\n  });\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n\r\n// ==============================\r\n// ONBOARDING MICROEMPRESA (wizard)\r\n// ==============================\r\n\r\n// Paso 1: crear microempresa PENDIENTE (sin login)\r\nexport const startMicroempresaOnboarding = async (payload) => {\r\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/start`, {\r\n    method: \"POST\",\r\n    headers: { \"Content-Type\": \"application/json\" },\r\n    credentials: \"include\",\r\n    body: JSON.stringify(payload),\r\n  });\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n\r\n// Paso 3: subir comprobante + plan elegido (multipart)\r\nexport const submitMicroempresaPayment = async ({ signup_id, id_plan, file }) => {\r\n  const formData = new FormData();\r\n  formData.append(\"signup_id\", String(signup_id));\r\n  formData.append(\"id_plan\", String(id_plan));\r\n  formData.append(\"file\", file);\r\n\r\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/submit`, {\r\n    method: \"POST\",\r\n    credentials: \"include\",\r\n    body: formData,\r\n  });\r\n\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n\r\n// Consultar estado (en espera / aprobado / rechazado)\r\nexport const getOnboardingStatus = async (signup_id) => {\r\n  const response = await fetch(\r\n    `${API_BASE}/api/onboarding/microempresa/status?signup_id=${encodeURIComponent(\r\n      String(signup_id)\r\n    )}`,\r\n    { credentials: \"include\" }\r\n  );\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n\r\n// ==============================\r\n// SUPER USUARIO: pendientes\r\n// ==============================\r\nexport const fetchPendingMicroempresas = async () => {\r\n  const response = await fetch(`${API_BASE}/api/onboarding/microempresa/pending`, {\r\n    credentials: \"include\",\r\n  });\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n\r\nexport const approvePendingMicroempresa = async (tenant_id) => {\r\n  const response = await fetch(\r\n    `${API_BASE}/api/onboarding/microempresa/${encodeURIComponent(String(tenant_id))}/approve`,\r\n    {\r\n      method: \"PATCH\",\r\n      credentials: \"include\",\r\n    }\r\n  );\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n\r\nexport const rejectPendingMicroempresa = async (tenant_id) => {\r\n  const response = await fetch(\r\n    `${API_BASE}/api/onboarding/microempresa/${encodeURIComponent(String(tenant_id))}/reject`,\r\n    {\r\n      method: \"PATCH\",\r\n      credentials: \"include\",\r\n    }\r\n  );\r\n  const data = await safeJson(response);\r\n  return { response, data };\r\n};\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}