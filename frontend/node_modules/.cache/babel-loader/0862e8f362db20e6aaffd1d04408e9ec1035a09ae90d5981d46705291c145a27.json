{"ast":null,"code":"const API_BASE = process.env.REACT_APP_API_BASE || \"\";\nconst safeJson = async response => {\n  try {\n    return await response.json();\n  } catch {\n    return {};\n  }\n};\nexport const login = async ({\n  username,\n  password,\n  role\n}) => {\n  const response = await fetch(`${API_BASE}/api/login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      username,\n      password,\n      role\n    })\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const register = async payload => {\n  const response = await fetch(`${API_BASE}/api/register`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify(payload)\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const guestLogin = async () => {\n  const response = await fetch(`${API_BASE}/api/guest-login`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\"\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const fetchMe = async () => {\n  const response = await fetch(`${API_BASE}/api/me`, {\n    credentials: \"include\"\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const logout = async () => {\n  const response = await fetch(`${API_BASE}/api/logout`, {\n    method: \"POST\",\n    credentials: \"include\"\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\nexport const switchRole = async role => {\n  const response = await fetch(`${API_BASE}/api/switch-role`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      role\n    })\n  });\n  return response.json().then(data => ({\n    response,\n    data\n  }));\n};\n\n// ✅ Password Reset\n// ===============================\nexport const requestPasswordReset = async ({\n  email,\n  role\n}) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/request`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      email,\n      role\n    })\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};\nexport const confirmPasswordReset = async ({\n  email,\n  role,\n  token,\n  new_password\n}) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/confirm`, {\n    method: \"POST\",\n    headers: {\n      \"Content-Type\": \"application/json\"\n    },\n    credentials: \"include\",\n    body: JSON.stringify({\n      email,\n      role,\n      token,\n      new_password\n    })\n  });\n  const data = await safeJson(response);\n  return {\n    response,\n    data\n  };\n};","map":{"version":3,"names":["API_BASE","process","env","REACT_APP_API_BASE","safeJson","response","json","login","username","password","role","fetch","method","headers","credentials","body","JSON","stringify","then","data","register","payload","guestLogin","fetchMe","logout","switchRole","requestPasswordReset","email","confirmPasswordReset","token","new_password"],"sources":["C:/Users/mayco/OneDrive/Escritorio/proyTaller/V3.9/aplicacion_microempresa/aplicacion_microempresa/frontend/src/controllers/authController.js"],"sourcesContent":["const API_BASE = process.env.REACT_APP_API_BASE || \"\";\n\nconst safeJson = async (response) => {\n  try {\n    return await response.json();\n  } catch {\n    return {};\n  }\n};\n\nexport const login = async ({ username, password, role }) => {\n  const response = await fetch(`${API_BASE}/api/login`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ username, password, role }),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const register = async (payload) => {\n  const response = await fetch(`${API_BASE}/api/register`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify(payload),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const guestLogin = async () => {\n  const response = await fetch(`${API_BASE}/api/guest-login`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const fetchMe = async () => {\n  const response = await fetch(`${API_BASE}/api/me`, {\n    credentials: \"include\",\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const logout = async () => {\n  const response = await fetch(`${API_BASE}/api/logout`, {\n    method: \"POST\",\n    credentials: \"include\",\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\nexport const switchRole = async (role) => {\n  const response = await fetch(`${API_BASE}/api/switch-role`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ role }),\n  });\n  return response.json().then((data) => ({ response, data }));\n};\n\n// ✅ Password Reset\n// ===============================\nexport const requestPasswordReset = async ({ email, role }) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/request`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ email, role }),\n  });\n\n  const data = await safeJson(response);\n  return { response, data };\n};\n\nexport const confirmPasswordReset = async ({ email, role, token, new_password }) => {\n  const response = await fetch(`${API_BASE}/api/password-reset/confirm`, {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    credentials: \"include\",\n    body: JSON.stringify({ email, role, token, new_password }),\n  });\n\n  const data = await safeJson(response);\n  return { response, data };\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}